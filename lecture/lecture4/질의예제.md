1. 쿼리스트링 쿼리
일반적인 lucene boolean 파서 문법을 따름
<pre><code>
POST store/_search
</code></pre>

<pre><code>
{
    "query" : {
        "query_string" : {
            "query" : "elastic"
        }
    }
}
</code></pre>

추가 가능 옵션
query
fields
default_operator
analyzer
minimum_should_match


2.TERM  쿼리 ,TERM 필터
Term쿼리
<pre><code>
POST store/_search
</code></pre>
<pre><code>
{
    {
        "query" : {
            "term" : {
                "title" : "문재인"
        }
    }
}
</code></pre>

Term 필터
<pre><code>
POST store/_search
</code></pre>
<pre><code>
{
    "query" : {
        "filtered" : {
            "query" : {
                "match_all" : {}
            }
        },
        "filter" : {
            "term": {
                "tags":"elastic"
            }
        }
    }
}
</code></pre>

Terms 쿼리 (다중 텀)
<pre><code>
POST store/_search
</code></pre>
<pre><code>
{
    "query" : {
        "terms" : {
            "title" : ["문재인","대통령"],
            "minimum_should_match": 2
        }
    }
}
</code></pre>

3. Match 쿼리
<pre><code>
POST store/_search
</code></pre>
<pre><code>
{
    "query" : {
        "match" : {
            "title" : {
                "query":"Elastic Search",
                "operator":"and"
            }
        }
    }
}
</code></pre>

4.Phrase 쿼리
<pre><code>
POST store/_search
</code></pre>
<pre><code>
{
    "query" : {
        "match" : {
            "title" : {
                "type": "phrase",
                "query": "elastic search",
                "slop": 1
            }
        }
    }
}
</code></pre>

5. Multi Match 쿼리
<pre><code>
POST store/_search
</code></pre>
<pre><code>
{
    "query" : {
        "multi_match" : {
            "query" : "Elastic Search",
            "fields":["title","author"]
        }
    }
}
</code></pre>

6. RANGE 쿼리,RANGE 필터
Range 쿼리
<pre><code>
POST store/_search
</code></pre>
<pre><code>
{
    "query" : {
        "range" : {
            "created_on" : {
                "gt":"2017-01-01",
                "lt":"2017-10-01"
            }
        }
    }
}
</code></pre>

Range 필터
<pre><code>
POST store/_search
</code></pre>
<pre><code>
{
    "query" : {
        "filtered" : {
            "query " : {
                "match_all" : {}
            }
        },
        "filter" : {
            "range": {
                "created_on" : {
                    "gt":"2017-01-01",
                    "lt":"2017-10-01"
                }
            }
        }
    }
}
</code></pre>

7. NESTED 쿼리(중첩쿼리)

1) 중첩 매핑 설정

<pre><code>
PUT nested_index/
</code></pre>
<pre><code>
{
  "mappings": {
    "nested_type": {
      "properties": {
        "user": {
          "type": "nested"
        }
      }
    }
  }
}
</code></pre>

2) 데이터 입력
<pre><code>
PUT nested_index/nested_type/1
</code></pre>
<pre><code>
{
  "group" : "fans",
  "user" : [
    {
      "first" : "John",
      "last" :  "Smith"
    },
    {
      "first" : "Alice",
      "last" :  "White"
    }
  ]
}
</code></pre>

3) 중첩 쿼리
<pre><code>
POST nested_index/_search
</code></pre>
<pre><code>
{
  "query": {
    "nested": {
      "path": "user",
      "query": {
        "bool": {
          "must": [
            { "match": { "user.first": "Alice" }},
            { "match": { "user.last":  "Smith" }}
          ]
        }
      }
    }
  }
}
</code></pre>


8. Parent-Child 릴레이션 쿼리
1) 데이터 매핑
** 부모는 매핑 정의가 되어 있지 않아야 함

<pre><code>
PUT my_index
</code></pre>
<pre><code>
{
  "mappings": {
    "my_parent": {},
    "my_child": {
      "_parent": {
        "type": "my_parent"
      }
    }
  }
}
</code></pre>

2) 데이터 입력

<pre><code>
PUT my_index/my_parent/1
</code></pre>
<pre><code>
{
  "text": "This is a parent document"
}
</code></pre>

<pre><code>
PUT my_index/my_child/2?parent=1
</code></pre>
<pre><code>
{
  "text": "This is a child document"
}
</code></pre>

<pre><code>
PUT my_index/my_child/3?parent=1&refresh=true
</code></pre>
<pre><code>
{
  "text": "This is another child document"
}
</code></pre>


3) Has_Child 쿼리

<pre><code>
POST my_index/my_parent/_search
</code></pre>
<pre><code>
{
  "query": {
    "has_child": {
      "type": "my_child",
      "query": {
        "match": {
          "text": "child document"
        }
      }
    }
  }
}
</code></pre>

